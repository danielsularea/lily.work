!function(t){"use strict";var a,e=window.Main||{},l=e.settings={headerScroll:"js--headerScroll",staticryptForm:"js--staticryptForm",staticryptInsertHeader:"js--staticryptInsertHeader",staticryptInsertArticle:"js--staticryptInsertArticle",workMenu:"js--workMenu",workMenuLink:"js--workMenuLink",zoomImages:'[data-action="zoom"]'},d="lilychen",o=function(t,e){var n=document.documentElement.offsetHeight-window.innerHeight;n<=t?t=n:t<=0&&(t=0);var r=(t-window.scrollY)/e*10;setTimeout(function(){window.scrollTo(window.scrollX,window.scrollY+r),window.scrollY!==t&&o(t,e-10)},10)},c=function(t){if(t)return t.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop)},f=function(t,e){var n=t.dataset.header,r=t.dataset.articleBefore,o=t.dataset.articleAfter;t.remove();var s=document.getElementsByClassName(l.staticryptInsertHeader),i=document.getElementsByClassName(l.staticryptInsertArticle);s[0]&&s[0].insertAdjacentHTML("beforeend",n),i[0]&&i[0].insertAdjacentHTML("beforeend",r+marked(e)+o),m(),u(),w()},r=function(){var t=document.getElementsByClassName(l.staticryptForm);if(t[0]){var e=sessionStorage.getItem(d);if(e){var n=t[0],r=n.dataset.encrypted,o=r.substring(0,64),s=r.substring(64);CryptoJS.HmacSHA256(s,CryptoJS.SHA256(e).toString()).toString()===o&&f(n,CryptoJS.AES.decrypt(s,e).toString(CryptoJS.enc.Utf8))}}},u=function(){mediumZoom(document.querySelectorAll(l.zoomImages))},n=function(){a={exists:!1,element:void 0,offsetY:0,links:{},refs:{}};var t=document.getElementsByClassName(l.workMenu);if(t[0]){var e=t[0],n=e.dataset.offsety?e.dataset.offsety:0;a.exists=!0,a.element=t[0],a.offsetY=n;for(var r=document.querySelectorAll("."+l.workMenu+" a"),o=0;o<r.length;o++){var s=r[o].getAttribute("href").split("#")[1],i=document.getElementById(s);a.links[s]=r[o],a.refs[s]=i}}},m=function(){n()},s=function(){if(a.exists){var t=a.element,e=t.parentNode,n=e.offsetTop,r=a.offsetY,o=window.pageYOffset||document.documentElement.scrollTop;c(e);t.style.opacity=n-r-75<=o?1:0,n-o<=r?(t.style.width=e.offsetWidth+"px",t.style.position="fixed",t.style.top=r+"px"):(t.style.width="auto",t.style.position="static")}},i=function(t){if(a.exists){t.preventDefault();var e=t.target.getAttribute("href").split("#")[1],n=a.refs[e],r=parseInt(c(n))-a.offsetY;t.target.blur(),o(r,300)}},p=function(t){t.preventDefault();var e=document.getElementsByClassName(l.staticryptForm);if(e[0]){var n=e[0],r=n.querySelectorAll('[type="password"]'),o=n.querySelectorAll('[type="submit"]');if(r[0]&&o[0]){var s=r[0].value,i=n.dataset.encrypted,a=i.substring(0,64),c=i.substring(64);if(CryptoJS.HmacSHA256(c,CryptoJS.SHA256(s).toString()).toString()!==a)return alert("Bad passphrase!"),void r[0].select();sessionStorage.setItem(d,s.toString()),f(n,CryptoJS.AES.decrypt(c,s).toString(CryptoJS.enc.Utf8))}}},v=function(){if(a.exists){a.element;var t=window.pageYOffset||document.documentElement.scrollTop,e=function(){var t={};for(var e in a.refs){var n=parseInt(c(a.refs[e]));t[e]=n-a.offsetY}return t}(),n=document.documentElement.offsetHeight-window.innerHeight;for(var r in a.links){var o=a.links[r].parentNode.classList;if(o.contains(l.workMenuLink)){var s=e[r];if(o.remove("active"),s-1<=t||n<=t){for(var i in a.links)a.links[i].parentNode.classList.remove("active");o.add("active")}}}}},y=function(){m(),s()},g=function(){!function(){var t=document.getElementsByClassName(l.headerScroll);if(t[0]){var e=t[0];0<(window.pageYOffset||document.documentElement.scrollTop)?e.classList.add("fixed"):e.classList.remove("fixed")}}(),s(),v()},w=function(){for(var t in window.addEventListener("resize",y),document.addEventListener("scroll",g),document.addEventListener("submit",p),a.links)a.links[t].addEventListener("click",i)};e._init=function(){Barba.Pjax.getTransition=function(){return Transition},document.addEventListener("DOMContentLoaded",function(t){Barba.Pjax.start()}),Barba.Dispatcher.on("transitionCompleted",function(t,e,n){r(),m(),u(),w()}),r(),m(),u(),w()},e._init()}();